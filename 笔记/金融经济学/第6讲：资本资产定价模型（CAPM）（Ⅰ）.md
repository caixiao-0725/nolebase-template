# 金融经济学 | 第6讲：资本资产定价模型（CAPM）（Ⅰ）

___

##  **1. 市场组合**

通过第5讲我们知道，所有理性投资者都应该以市场组合 $M$ 的形式持有风险资产。那么，市场组合 $M$ 具体是什么呢？

市场组合 $M$ 应当包含所有的风险资产，甚至包含诸如房地产、人力资本这样的极少在市场上交易的资产。而 $M$ 中各类资产的权重占比就是世界上各类风险资产价值的比率。换言之，市场组合就是包含了所有风险资产的整个市场。

为什么会这么巧呢？（因为根据资产的回报率与波动状况，完全有可能用均值方差分析方法计算出来的组合权重与市场中各类资产的组合比重不一致。甚至，有可能计算出来某些资产的组合权重为0，乃至是负数。）

市场组合是整个市场这一结论，依赖于大量前提条件。其中一个关键是，资产的收益和波动状况并非一成不变，而是会根据资产的波动状况来进行调整，以保证各类资产市场都出清（供需相等）。因此，如果均值方差分析计算出来的某些资产的组合权重为0，乃至是负数，那么意味着这些资产的收益和波动状况需要进行调整，以吸引投资者投资（又或者是退出市场）。

这样，我们就从均值方差分析的个人选择层面，进入了对市场是否出清，也即经济是否达到均衡的思考。

所谓**均衡**，简单来说就是所有人都和谐地做到了最好。其关键在于：①所有人都做到最好。即，所有人都实现了自己的理性；②和谐。所有人的最优行为彼此相容（由价格的调整来实现）。

回到均值方差分析。如果计算出来的市场组合与市场的构成不一致，那么一定意味着某些资产市场没有出清——供过于求或是供不应求。对那些供过于求的资产来说，其提供者一定有降价销售资产的动力，这样会提升资产的预期回报率，从而增加资产的需求。供不应求的状况与之类似。所以，在均衡时，各类资产的价格（预期回报率）应当处在恰当水平，从而保证每种资产在整个资产市场中的比重就是理性投资者组合优化会选择的组合权重。这样一来，投资者会选择的市场组合就变成了整个市场。

简单总结一下逻辑：如果市场组合与整个市场不同，则某些资产的供需一定不平衡，从而必然引发资产价格调整，最终使得市场组合一定等同于整个市场。

那么，我们不禁思考，在均衡的时候，资产价格会不会满足什么特别的规律？

由Sharpe首创的资本资产定价模型（Capital Asset Pricing Model，简称CAPM）——均衡时的资产预期回报率满足一种线性关系。

___
##  **2. CAPM的假设**


资产定价理论研究的是给定资产未来的支付预期后，资产现在的价格应该是多少。而在支付预期给定的前提下，资产现在的价格与资产预期的回报率实际上是一回事。CAPM之所以叫定价模型，是因为它给出了有关资产期望回报率的结论。

关于CAPM的假设有7个：

①没有交易成本（佣金、买卖价差等）；

②没有税收；

③所有资产都可以任意交易，并且无限可分；

④完全竞争：所有人都是价格的接受者，没有影响价格的能力；

⑤所有人都以均值方差的方式选择投资组合：偏好更高的期望回报率，以及更低的回报率波动率；

⑥所有资产（包括无风险资产）都可以任意买空卖空；

⑦一致预期：所有人针对相同的时间区间（1期）考虑投资问题，并且对资产的预期回报率和预期波动率状况 $\{E(r_1),\cdots,E(r_n);\sigma(r_1),\cdots,\sigma(r_n)\}$ 有相同预期。

假设①-④是对市场所做的简化假设，假设⑤-⑦意味着所有人都将财富在无风险资产和市场组合之间进行分配。


___

##  **3. CAPM的第一种论证：基于效用函数**

我们知道，在均衡时，所有投资者都达到最优化，因而没有偏离现状的动力。那么，对于那种只持有市场组合，完全不持有无风险资产（也不用无风险利率借贷）的投资者，其组合选择也应该是最优化的。我们假设他的偏好以下面的效用函数来刻画：

 $$u(r)=E(r)-A\sigma^2(r) $$

其中， $A$ 是一个度量风险厌恶程度的恰当常数（ $A$ 严格大于0以确保投资者是风险厌恶的），并且 $A$ 使得这个投资者在均衡时只持有市场组合，而完全不持有风险资产。

那么，我们假设投资者将财富的 $1-w$ 份额放在市场组合 $M$ 上，剩下的 $w$ 财富则投资在资产 $i$ 上，我们称组合 $M$ 和资产 $i$ 合成的新组合为组合 $p$ ，显然，组合 $p$ 的效用要小于或等于仅仅持有组合 $M$ （即 $w=0$ ）的效用（对于这个投资者而言）。

假设资产 $i$ 的期望回报率为 $E(r_i)$ ，回报率波动方差为 $\sigma^2(r_i)$ ，回报率与市场组合回报率的协方差为 $\sigma_{iM}$ 。

组合 $p$ 带给投资者的效用为
 $$\begin{aligned} u(r_p)&=u[wr_i+(1-w)r_M]\\ &=E[wr_i+(1-w)r_M]-A\sigma^2[wr_i+(1-w)r_M]\\ &=wE[r_i]+(1-w)E[r_M]-A(w^2\sigma_i^2+(1-w)^2\sigma_M^2+2w(1-w)\sigma_{iM})\\ &=wE[r_i]+(1-w)E[r_M]-A[w^2\sigma_i^2+w^2\sigma_M^2-2w\sigma_M^2+\sigma_M^2-2w^2\sigma_{iM}+2w\sigma_{iM}]\\ &=wE[r_i]+(1-w)E[r_M]-Aw^2(\sigma_i^2+\sigma_M^2-2\sigma_{iM})-2Aw(\sigma_{iM}-\sigma_M^2)-A\sigma_M^2 \end{aligned} $$

在 $w=0$ 时，效用取得最大值，这意味着 $\frac{du(r_p)}{dw}\mid_{w=0}=0$ 。又
 $$\frac{du(r_p)}{dw}=E[r_i]-E[r_M]-2wA(\sigma_i^2+\sigma_M^2-2\sigma_{iM})-2A(\sigma_{iM}-\sigma_M^2) $$

当 $w=0$ 时，上式即为
 $$E[r_i]-E[r_M]-2A(\sigma_{iM}-\sigma_M^2)=0 $$
因此，
 $$A=\frac{E[r_i]-E[r_M]}{2(\sigma_{iM}-\sigma_M^2)} $$
设想一下，当 $i$ 为无风险资产时，关于 $A$ 的表达式也应该成立，即
 $$A=\frac{E[r_f]-E[r_M]}{2(\sigma_{fM}-\sigma_M^2)} $$

又因为无风险资产与其他资产的协方差为0，因此有
 $$A=\frac{E[r_M]-r_f}{2\sigma_M^2}$$

将 $A$ 代入式 $E[r_i]-E[r_M]-2A(\sigma_{iM}-\sigma_M^2)=0$ 中，有
 $$\begin{aligned} &E[r_i]-E[r_M]-2\frac{E[r_M]-r_f}{2\sigma_M^2}(\sigma_{iM}-\sigma_M^2)=0\\ \Rightarrow & E[r_i]-E[r_M]-(E[r_M]-r_f)\frac{\sigma_{iM}}{\sigma_M^2}+(E[r_M]-r_f)=0\\ \Rightarrow & E[r_i]-r_f=\frac{\sigma_{iM}}{\sigma_M^2}[E[r_M]-r_f] \end{aligned} $$
如果定义 $\beta=\frac{\sigma_{iM}}{\sigma_M^2}$ ，则我们可以得到CAPM方程
$$E(r_i)-r_f=\beta_i[E(r_M)-r_f] $$
CAPM定价方程表明，均衡时所有资产的期望回报率之间存在一个线性关系。线性关系的自变量是各个资产的 $\beta$ ，斜率则是市场组合的超额回报率。

在前面的证明中，我们假设存在一个只持有市场组合 $M$ ，而在无风险资产 $r_f$ 上无任何头寸的投资者。我们也可以给定任意一位投资者，他的财富在无风险资产和市场组合上的权重分别为 $1-\mu$ 和 $\mu$ 。我们称此组合为组合 $\mu$ 。显然，
 $$E[r_\mu]=(1-\mu)r_f+\mu E[r_M]\,,\quad \sigma_{\mu}^2=\mu^2\sigma_M^2 $$

假设投资者将财富的 $1-w$ 份额放在组合 $\mu$ 上，剩下的 $w$ 财富则投资在资产 $i$ 上，我们称组合 $\mu$ 和资产 $i$ 合成的新组合为组合 $p$ ，显然，组合 $p$ 的效用要小于或等于仅仅持有组合 $\mu$ （即 $w=0$ ）的效用。

假设资产 $i$ 的期望回报率为 $E(r_i)$ ，回报率波动方差为 $\sigma^2(r_i)$ ，回报率与组合 $\mu$ 回报率的协方差为 $\mu\sigma_{iM}$ 。

与前文一样，组合 $p$ 带给投资者的效用为
$$\begin{aligned} u(r_p)&=u[wr_i+(1-w)r_\mu]\\ &=E[wr_i+(1-w)r_\mu]-A\sigma^2[wr_i+(1-w)r_\mu]\\ &=wE[r_i]+(1-w)E[r_\mu]-A(w^2\sigma_i^2+(1-w)^2\sigma_{\mu}^2+2w(1-w)\mu\sigma_{iM})\\ &=wE[r_i]+(1-w)[(1-\mu)r_f+\mu E[r_M]]-A[w^2\sigma_i^2+w^2\mu^2\sigma_M^2-2w\mu^2\sigma_M^2+\mu^2\sigma_M^2-2w^2\mu\sigma_{iM}+2w\mu\sigma_{iM}]\\ &=wE[r_i]+(1-w)[(1-\mu)r_f+\mu E[r_M]]-Aw^2(\sigma_i^2+\mu^2\sigma_M^2-2\mu\sigma_{iM})-2Aw(\mu\sigma_{iM}-\mu^2\sigma_M^2)-A\mu^2\sigma_M^2 \end{aligned} $$
又
$$\frac{du(r_p)}{dw}=E[r_i]-(1-\mu)r_f-\mu E[r_M]-2wA(\sigma_i^2+\mu^2\sigma_M^2-2\mu\sigma_{iM})-2A(\mu\sigma_{iM}-\mu^2\sigma_M^2) $$
当 $w=0$ 时，上式即为
 $$E[r_i]-(1-\mu)r_f-\mu E[r_M]-2A(\mu\sigma_{iM}-\mu^2\sigma_M^2)=0 $$
因此，有
$$A=\frac{E[r_i]-(1-\mu)r_f-\mu E[r_M]}{2(\mu\sigma_{iM}-\mu^2\sigma_M^2)} $$

  
当资产 $i$ 为无风险资产时，上式也同样应该成立，则有
$$A=\frac{E[r_M]-r_f}{2\mu\sigma_M^2} $$
代入式 $E[r_i]-\mu E[r_M]-2A(\mu\sigma_{iM}-\mu^2\sigma_M^2)=0$ 中，有
$$\begin{aligned} & E[r_i]-(1-\mu)r_f-\mu E[r_M]-2\frac{E[r_M]-r_f}{2\mu\sigma_M^2}(\mu\sigma_{iM}-\mu^2\sigma_M^2)=0\\ \Rightarrow & E[r_i]-(1-\mu)r_f-\mu E[r_M]-\frac{E[r_M]-r_f}{\sigma_M^2}\sigma_{iM}+(\mu E[r_M]-\mu r_f)=0\\ \Rightarrow & E[r_i]-r_f=\frac{\sigma_{iM}}{\sigma_M^2}[E[r_M]-r_f] \end{aligned} $$

因此，我们同样可以得到CAPM方程。

___

 **参考文献：** 《金融经济学二十五讲》. 徐高. 中国人民大学出版社. 2018-7
 
<iframe src="https://player.bilibili.com/player.html?isOutside=true&aid=113530078496060&bvid=BV1fgByYtEfc&cid=26924224081&p=32&autoplay=false" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>
